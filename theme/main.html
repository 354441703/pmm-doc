{#
  MkDocs template for PMM
  Derived from Sphinx percona theme layout.html
#}

{%- set reldelim1 = reldelim1 is not defined and ' &raquo;' or reldelim1 %}
{%- set reldelim2 = reldelim2 is not defined and ' |' or reldelim2 %}
{%- set render_sidebar = (not embedded) and (not theme_nosidebar) and (sidebars != []) %}
{%- set url_root =  base_url|url %}
{%- set docstitle = config.site_name %}

{# XXX necessary? #}
{%- if url_root == '#' %}{% set url_root = '' %}{% endif %}

{%- if not embedded and docstitle %}
  {%- set titlesuffix = " &mdash; "|safe + docstitle|e %}
{%- else %}
  {%- set titlesuffix = "" %}
{%- endif %}

{% macro relbar() %}
<div class="related row">
  <ul class="nav nav-pills">


    {# NEXT #}
    {% if page.next_page %}
    <li class="right" style="margin-right: 10px">
      <a href="{{ page.next_page.url|url }}" title="{{ page.next_page.title }}">next</a>
    </li>
    {% endif %}

    {# PREVIOUS #}
    {% if page.previous_page %}
    <li class="right" style="margin-right: 10px">
      <a href="{{ page.previous_page.url|url }}" title="{{ page.previous_page.title }}">previous</a>
    </li>
    {% endif %}

    {# PARENT #}
    {% if page.parent %}
    <li>
      <a href="{{ page.parent.url|url }}">{{ page.parent.title|e }}</a>
    </li>
    {% endif %}

    {# HOME #}
    <li>
      <a href="{{ url_root }}">{{ config.extra.shorttitle|e }}</a>
    </li>

  </ul>
</div>
{% endmacro %}

{%- macro sidebar() %}
{%- if render_sidebar %}
<div class="sphinxsidebar  col-md-3 col-md-pull-9">
  <div class="sphinxsidebarwrapper">
    {@ product_logo @}
    {@ product_pdf_download @}

    {%- if sidebars != None %}
    {#- new style sidebar: explicitly include/exclude templates #}
    {%- for sidebartemplate in sidebars %}
    {%- include sidebartemplate %}
    {%- endfor %}
    {%- else %}
    {#- old style sidebars: using blocks -- should be deprecated #}
    {%- block sidebartoc %}
    {%- include "localtoc.html" %}
    {%- endblock %}
    {%- block sidebarrel %}
    {%- include "relations.html" %}
    {%- endblock %}

    {%- if customsidebar %}
    {%- include customsidebar %}
    {%- endif %}

    {%- include "searchbox.html" %}

    {%- endif %}
    {@ product_series @}
  </div>
</div>
{%- endif %}
{%- endmacro %}

{%- macro script() %}
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '{{ config.site_url }}',
        VERSION:     '{{ config.extra.release|e }}',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '{{ '' if no_search_suffix else file_suffix }}',
        HAS_SOURCE:  {{ has_source|lower }}
      };
    </script>
    {%- for scriptfile in script_files %}
    <script type="text/javascript" src="{{ scriptfile }}"></script>
    {%- endfor %}
{%- endmacro %}


{%- macro css() %}
    <link rel="stylesheet" href="{{ '_static/pygments.css' }}" type="text/css" />
    {%- for cssfile in config.extra_css %}
      <link rel="stylesheet" href="{{ cssfile }}" type="text/css" />
    {%- endfor %}
{%- endmacro %}


{%- block htmltitle %}
  <title>{% if page.title %}{{ page.title }} &mdash; {% endif %}{{ docstitle }}</title>
  {%- endblock %}

  <head>
    {{ metatags }}
    {{ css() }}
    {{ script() }}
    {# TODO opensearch #}

    {%- block linktags %}
      {# TODO linktags #}
      <link rel="top" title="{{ docstitle|e }}" href="{{ config.base_url|url }}" />
      {%- if page.next_page %}
      <link rel="next" title="{{ page.next_page.title|striptags|e }}" href="{{ page.next_page.url|e }}" />
      {%- endif %}
      {%- if page.previous %}
      <link rel="prev" title="{{ page.previous.title|striptags|e }}" href="{{ page.previous.url|e }}" />
      {%- endif %}
    {%- endblock %}
  </head>

  <body>
    <div class="container">
    <div class="document row">
      <div class="documentwrapper col-md-9 col-md-push-3">
        {{ relbar() }}
        <div class="bodywrapper">
          <div class="body">
            {% if page.is_top_level and page.is_index and page.file.url == 'index.html' %}
              {% if nav|length>1 %}
                <ul>
                  {% for nav_item in nav %}
                    {% if nav_item.children %}
                      <li>{{ nav_item.title }}
                        <ul>
                        {% for nav_item in nav_item.children %}
                            <li class="{% if nav_item.active%}current{% endif %}">
                                <a href="{{ nav_item.url|url }}">{{ nav_item.title }}</a>
                            </li>
                        {% endfor %}
                        </ul>
                      </li>
                    {% else %}
                      <li class="{% if nav_item.active%}current{% endif %}">
                        <a href="{{ nav_item.url|url }}">{{ nav_item.title }}</a>
                      </li>
                    {% endif %}
                  {% endfor %}
                </ul>
              {% endif %}
            {% else %}
              {{ page.content }}
            {% endif %}
          </div>
        </div>
        {{ relbar() }}
      </div>
      {{ sidebar() }}
      <div class="clearer"></div>
    </div>
  </div>
</body>
